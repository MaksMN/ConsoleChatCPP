# Консольный чат
## 27.7. Итоговое задание

#### ЗАДАЧА
Добавьте в ваш проект чата логгирование сообщений от других участников чата и своих сообщений.

Для этого напишите класс Logger, через который будет проходить вся работа с файлом логов. Сохраняйте сообщения в файл на диске, можете назвать его log.txt. При создании объекта логгера должно производиться открытие файла, а при его разрушении — закрытие файла (концепт RAII).

Реализуйте в классе два метода:

запись строки логов в файл;
чтение одной строки из файла.
Конечно же, запись и чтение должны быть потокобезопасными — при одновременном вызове нескольких потоков с записью в файл и чтением из файла, не должно происходить взаимоблокировок и гонок данных.

Не забывайте про принципы инкапсуляции: код, пользующийся вашими методами чтения и записи, не должен знать про многопоточность.

#### Реализовано
Задача реализована полностью. 

Сообщения чата записываются в файл access.log в серверной части чата. Для записи лога надо ввести любую команду в клиенте чата.

Чтение последней строки лога производится в консоли сервера командой ```/log```

## Описание реализации задания.

Концепция всего проекта в целом: https://github.com/MaksMN/ConsoleChatFP/tree/HW_mod25

Данное задание реализовано следующим образом:

Основной класс Server\Socket\Logger\Logger.h имеет два метода: writer и reader
Дополнительный класс Server\Socket\Logger\LoggerThread.h так же имеет два метода: writer и reader

В классе Logger в методах writer и reader создаются новые экземпляры LoggerThread.

LoggerThread в свою очередь вызывает чтение и запись файлов в потоках.

Мьютекс создается в классе Logger и передается в LoggerThread по ссылке. В результате чего все экземпляры LoggerThread получают один и тот же мьютекс.

В деструкторе LoggerThread задается присоединение к потокам, в результате чего работа потоков должна корректно завершиться при разрушении класса.

В классе Logger создается поле fstream и передается по ссылке LoggerThread

В конечном итоге получилась система в котрой приостанавливается запись при чтении файла или приостанавливается чтение при записи. Тем самым работа с логами становится потокобезопасной.

Для возможности чтения строки из лога реализован дополнительный поток на сервере который принимает команды консоли. Чтение последней строки лога производится в консоли сервера командой ```/log```

<hr>

Проект кроссплатформенный. Клиент работает в обеих ОС. Сервер на Windows работает через API MySQL и ODBC, на Linux только API MySQL.